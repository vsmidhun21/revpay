<div class="page-layout">
  <div class="page-header">
    <div>
      <h1 class="page-title">Notifications</h1>
      <p class="page-sub">{{ unreadCount }} unread</p>
    </div>
    <div class="header-actions" *ngIf="activeTab === 'list'">
      <button class="btn-outline" (click)="markAllRead()"
        [disabled]="markingAll || unreadCount === 0">
        {{ markingAll ? 'Markingâ€¦' : 'Mark all read' }}
      </button>
    </div>
    <div class="header-actions" *ngIf="activeTab === 'preferences'">
      <button class="btn-primary" (click)="savePreferences()" [disabled]="prefsSaving">
        {{ prefsSaving ? 'Savingâ€¦' : 'Save Preferences' }}
      </button>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab" [class.active]="activeTab==='list'" (click)="activeTab='list'">
      Notification History
    </button>
    <button class="tab" [class.active]="activeTab==='preferences'" (click)="activeTab='preferences'">
      âš™ Preferences
    </button>
  </div>

  <!-- â”€â”€ Notification List Tab â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div *ngIf="activeTab === 'list'">
    <div class="loading-row" *ngIf="loading"><div class="spinner"></div></div>

    <div class="notif-list" *ngIf="!loading">
      <div class="empty-state" *ngIf="notifications.length === 0">
        <span class="empty-icon">ðŸ””</span>
        <p>No notifications yet.</p>
      </div>

      <div class="notif-item" *ngFor="let n of notifications"
        [class.unread]="!n.isRead" (click)="markRead(n)">
        <div class="notif-icon-wrap">{{ typeIcon(n.type) }}</div>
        <div class="notif-content">
          <p class="notif-message">{{ n.message }}</p>
          <span class="notif-time">{{ n.createdAt | date:'dd MMM y, h:mm a' }}</span>
        </div>
        <div class="unread-dot" *ngIf="!n.isRead"></div>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Preferences Tab â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div *ngIf="activeTab === 'preferences'">
    <div class="loading-row" *ngIf="prefsLoading"><div class="spinner"></div></div>

    <div class="prefs-panel" *ngIf="!prefsLoading">
      <div class="alert success" *ngIf="prefsSuccess">{{ prefsSuccess }}</div>
      <div class="alert error"   *ngIf="prefsError">{{ prefsError }}</div>

      <p class="prefs-desc">
        Choose which events send you a notification. Changes take effect immediately after saving.
      </p>

      <div class="pref-list">
        <div class="pref-item" *ngFor="let pref of prefOptions">
          <div class="pref-icon">{{ pref.icon }}</div>
          <div class="pref-info">
            <div class="pref-label">{{ pref.label }}</div>
            <div class="pref-desc">{{ pref.description }}</div>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" [(ngModel)]="preferences[pref.key]"/>
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>

      <div class="prefs-footer">
        <button class="btn-primary" (click)="savePreferences()" [disabled]="prefsSaving">
          {{ prefsSaving ? 'Savingâ€¦' : 'Save Preferences' }}
        </button>
      </div>
    </div>
  </div>
</div>